---
title: 'STATS 205: Homework Assignment 5'
author: "Brian Liu"
date: "6/10/2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Solution to Problem 1

>We say that two observations $X_1$ and $X_2$ are *independent* of one another with respect to a collection of events $\mathcal{A}$ if
>
>\[
>     Pr\left\{X_1 \in A \textrm{  and  } X_2 \in B\right\} = Pr\left\{X_1 \in A \right\}Pr\left\{X_2 \in B\right\}
>\]
>where A and B are any two not necessarily distinct sets of outcomes belonging to $\mathcal{A}^3$.

-- <cite>[2.2.1 Independent Observations; Permutation, Parametric, and Bootstrap Tests of Hypotheses; Good, Phillip I][1]</cite>

>In deciding whether your own observations are exchangeable and a permutation test applicable, the key question is the one we posed in the very first chapter: Under the null hypothesis of no differences among the various experimental or survey groups, can we exchange the labels on the observations without significantly affecting the results?

-- <cite>[2.2.2 Exchangeable Observations; Permutation, Parametric, and Bootstrap Tests of Hypotheses; Good, Phillip I][1]</cite>

[1]:https://searchworks.stanford.edu/view/12473402

## Solution to Problem 2

```{r}
cysticerci <- c(28.9, 32.8, 12.0, 9.9, 15.0, 38.0, 12.5, 36.5, 8.6, 26.8);cysticerci
worms_reco <- c(1.0, 7.7, 7.3, 7.9, 1.1, 3.5, 18.9, 33.9, 28.6, 25.0); worms_reco
```

The null hypothesis is that the mean weight of introduced cysticerci *has no correlation with* the mean weight of worms recovered. That is,

\[
    H_0: \tau = 0
\]

The alternative hypothesis is that the mean weight of introduced cysticerci is *positively correlated with* the mean weight of worms recovered. That is,

\[
    H_A: \tau > 0
\]

To test the null hypothesis against the alternative hypothesis, we will use the Kendall test, a distribution-free test for independence based on signs.

```{r}
cor.test(x = cysticerci, y = worms_reco, method = "kendall", alt = "greater")
```

The $p$-value is $0.7578$, which is *not* significant at the $\alpha = 0.05$ level. There is *not enough* evidence that the mean weight of introduced cysticerci is *positively correlated with* the mean weight of worms recovered.

## Solution to Problem 3

```{r}
cysticerci <- c(28.9, 32.8, 12.0, 9.9, 15.0, 38.0, 12.5, 36.5, 8.6, 26.8)
worms_reco <- c(1.0, 7.7, 7.3, 7.9, 1.1, 3.5, 18.9, 33.9, 28.6, 25.0)
cor.test(x = cysticerci, y = worms_reco, method = "kendall", alt = "greater")
```

The estimate for $\tau = -0.1555556$.

## Solution to Problem 4

## Solution to Problem 5

```{r}
cysticerci <- c(28.9, 32.8, 12.0, 9.9, 15.0, 38.0, 12.5, 36.5, 8.6, 26.8)
worms_reco <- c(1.0, 7.7, 7.3, 7.9, 1.1, 3.5, 18.9, 33.9, 28.6, 25.0)
```

The null hypothesis is that the mean weight of introduced cysticerci *has no correlation with* the mean weight of worms recovered. That is,

\[
    H_0: r_s < r_{s,\alpha}
\]

The alternative hypothesis is that the mean weight of introduced cysticerci is *positively correlated with* the mean weight of worms recovered. That is,

\[
    H_A: r_s \geq r_{s,\alpha}
\]

Otherwise, do not reject.

To test the null hypothesis against the alternative hypothesis, we will use the Spearman test, a distribution-free test for independence based on ranks.

<!-- # install.packages("SuppDists", dependencies=TRUE, repos='http://cran.us.r-project.org') -->

<!-- # qSpearman(0.01, r = 7) -->
```{r}
library(SuppDists)
qSpearman(p = 0.05, r = 10)
```

Since $r_{s,\alpha} = -0.5393939$, we will reject the null hypothesis only if $r_s \geq -0.5393939$.

Calculating $r_s$,

```{r}
cor(x = cysticerci, y = worms_reco, method = "spearman")
```

Since $r_s = -0.2$ and $r_{s,\alpha} = -0.5393939$, the statement $r_s \geq r_{s,\alpha}$ is *true*. Thus, we *reject* the null hypothesis. There is *sufficient* evidence that the mean weight of introduced cysticerci is *positively correlated with* the mean weight of worms recovered.

---

**NOTE**: At this point, I tried to use `cor.test()` with `method = "spearman"` but I got a different result than I expected, and I'm not sure why. Maybe I'm interpreting the output incorrectly?

```{r}
cor.test(x = cysticerci, y = worms_reco, method = "spearman", alternative = "greater")
```

The $p$-value is $0.72$, which is *not* significant at the $\alpha = 0.05$ level. There is *not enough* evidence that the mean weight of introduced cysticerci is *positively correlated with* the mean weight of worms recovered.

---

## Solution to Problem 6

```{r}
x = c(0, 5000, 10000, 15000, 20000, 25000, 30000, 100000)
y = c(0.924, 0.988, 0.992, 1.118, 1.133, 1.145, 1.157, 1.357)
```

The null hypothesis is that the mean weight of introduced cysticerci *has no correlation with* the mean weight of worms recovered. That is,

\[
    H_0: \beta = \beta_{0}
    H_0: \beta = 0
\]

The alternative hypothesis is that the mean weight of introduced cysticerci is *positively correlated with* the mean weight of worms recovered. That is,

\[
    H_A: \beta > \beta_{0}
    H_A: \beta > 0
\]

```{r}
install.packages("NSM3", dependencies=TRUE, repos='http://cran.us.r-project.org')
library(NSM3)
theil(x, y, alpha=0.05, beta.0=0, type = "upper")
```